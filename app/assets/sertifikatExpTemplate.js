const moment = require('moment')

const sertifikatExp = (data) => {   
    return `
    <table style="font-family: Arial, Helvetica, sans-serif; padding: 10px;">
        <tr>
            <th style="text-decoration: underline; font-size: x-large; padding: 40px;">
                Surat Pemberitahuan Validasi Sertifikat
            </th>
        </tr>
        <tr>
            <td style="text-align: justify;">
                Hi, <span style="color: DodgerBlue;">kami</span> informasikan bahwa data yang terlampir di bawah ini agar segera memperbarui sertifikatnya karena sertifikat sudah akan kadaluarsa.
            </td>
        </tr>
        <tr>
            <td>

                Berikut ini di lampirkan summary data:
            </td>
        </tr>
        <tr>
            <td style="padding: 20px 0px;">
                <table border="1" style="text-align: center;">
                    <tr style="background-color:lightgray;">
                        <th>No</th>
                        <th>Cabang</th>
                        <th>Nama</th>
                        <th>NIPP</th>
                        <th>Jenis Sertifikat</th>
                        <th>Kategori Sertifikat</th>
                        <th>Tanggal Kadaluarsa</th>                       
                    </tr>
${data.map(value=> '<tr>'+
'<td>'+value.NO+'</td>'+
'<td>'+value.CABANG+'</td>'+
'<td>'+value.NAMA+'</td>'+
'<td>'+value.NIPP+'</td>'+
'<td>'+value.JENIS_SERTIFIKAT+'</td>'+
'<td>'+value.KATEGORI_SERTIFIKAT+'</td>'+
'<td>'+moment(value.TANGGAL_KADALUARSA).format('DD MMMM YYYY')+'</td>'+
                    '</tr>').reduce((tot,mod)=>tot+=mod)}
                </table>
            </td>
        </tr>
        <tr>
            <td>
                Atas perhatiannya <span style="color: DodgerBlue;">kami</span> ucapkan terima kasih.
            </td>
        </tr>
        <tr>
            <td style="padding: 50px 0px 10px 0px;">
                <div>Regards, </div>
                <div>Admin Pelayanan Kapal Pusat</div>
            </td>
        </tr>
        <tr>
            <td style="font-style:italic;">
                This is autogenerated email please do not reply.
            </td>
        </tr>
    </table>
    `
}
//no, cabang, nama, nipp,	jenis_sertifikat, kategori_sertifikat, tanggal_kadaluarsa
module.exports = sertifikatExp